"use strict";var ContactForm=function(t){function c(e){e instanceof jQuery&&(this.$body=$("body"),this.handlers={},this.$form=e,this.letCloseWindow=!0,this.$loader=$('<div class="page-loader">'),this.getInputs().on("change",this.onInputChange.bind(this)),this.$form.on("submit",this.onSubmit.bind(this)),t.onbeforeunload=this.beforeUnload.bind(this))}return c.handlers={},c.inputs=["input[name=Nombre]","input[name=Telefono]","input[name=Email]","textarea[name=Mensaje]"],c.prototype={addHandler:function(e,t){this.handlers[e]=t},ajaxRequest:function(e,t){$.ajax({data:e,type:"GET",url:"http://goplek.com/mailer/send-mail.php",beforeSend:t.beforeSend,error:t.error,success:t.success})},beforeUnload:function(){if(!this.letCloseWindow)return"Sending message"},getInputs:function(){return this.$form.find(c.inputs.join())},hideLoader:function(){this.letCloseWindow=!0,this.$body.children().not("script").removeClass("blurry"),this.$loader.removeClass("displayed"),this.$loader.remove()},isInputValid:function(e){var t=e.attr("name"),n=e.val();if(!n)return!1;switch(t){case"Nombre":return 3<n.length;case"Telefono":return 10===n.replace(/[^0-9]/g,"").length;case"Email":return/[\w-\.]{3,}@([\w-]{2,}\.)*([\w-]{2,}\.)[\w-]{2,4}/.test(n);case"Mensaje":return!0;default:return console&&console.log&&console.log("Unknown validation type: "+t),!0}},showLoader:function(){this.letCloseWindow=!1,this.$body.children().not("script").addClass("blurry"),this.$loader.appendTo(this.$body),this.$loader.css("opacity"),this.$loader.addClass("displayed")},onInputChange:function(e){var t=$(e.target),n=t.data("error-element");if(this.isInputValid(t))n&&(n.fadeOut(function(){n.remove()}),t.data("error-element",null),t.css("border","1px solid #dcdcdc"));else{if(!n){var o=t.data("clue")||"Inválido";(n=$("<span>")).insertBefore(t).css({display:"none",color:"#f00"}).text(o).fadeIn(),t.data("error-element",n)}t.css("border","1px solid #f00")}},onSubmit:function(e){e.preventDefault();var t=$(e.target),o=this,n=!0;if(this.getInputs().each(function(){var e=$(this);o.isInputValid(e)||(e.trigger("change"),n=!1)}),n){var s={host:location.hostname,data:t.serialize()},i={},a=this.handlers,r=c.handlers,l=$('<div class="server-response">'),d=function(e){t.empty().append(e)};i.beforeSend=a.beforeSend||r.beforeSend||function(e,t){o.showLoader(),l.text("Enviando..."),d(l)},i.error=a.error||r.error||function(e,t,n){o.hideLoader(),l.text("Error: No se pudo entregar el mensaje."),d(l)},i.success=a.success||r.success||function(e,t,n){o.hideLoader(),parseInt(e)?l.text("El mensaje fue entregado correctamente."):l.text("No se pudo entregar el mensaje. Intentalo mas tarde."),d(l)},this.ajaxRequest(s,i)}else alert("Hay campos inválidos, por favor revisa las indicaciones en rojo.")},resetFormInputs:function(){this.$form.get(0).reset()}},c}(window),Page={$body:$("body"),$window:$(window),init:function(){Page.Navigation.init(),Page.Contact.init(),Page.$window.on("load",function(){Page._onLoad()}),Page.$window.on("resize",function(){Page._onResize()}),Page.$window.on("scroll",function(){Page._onScroll()})},_onLoad:function(){},_onResize:function(){},_onScroll:function(){},ga:function(o){function e(e,t,n){return o.apply(this,arguments)}return e.toString=function(){return o.toString()},e}(function(e,t,n){if("function"==typeof ga&&"string"==typeof e&&"string"==typeof t){var o={hitType:"event",eventCategory:e,eventAction:t,eventLabel:n||""};ga("send",o),"console"in window&&console.log("ga: [category: %s, action: %s, label: %s]",o.eventCategory,o.eventAction,o.eventLabel)}}),scrollTo:function(e,t,n){var o=$(e);if(o.length){var s=t||1e3,i=n||0,a=o.offset().top-i;$("html, body").stop().animate({scrollTop:a},s)}},Navigation:{$closeListBtn:null,$elem:null,$list:null,$toggleBtn:null,init:function(){this.$elem=$(".navigation"),this.$elem.length&&(this.$listWrapper=this.$elem.find(".list-wrapper"),this.$closeListBtn=this.$elem.find(".close-list-btn"),this.$toggleBtn=this.$elem.find(".toggle-btn"),this.toggleCollapsed=this.toggleCollapsed.bind(this),this.$closeListBtn.on("click",this.toggleCollapsed),this.$toggleBtn.on("click",this.toggleCollapsed))},toggleCollapsed:function(){this.$listWrapper.hasClass("list-collapsed")?(this.$listWrapper.removeClass("list-collapsed"),Page.$body.removeClass("no-scroll")):(this.$listWrapper.addClass("list-collapsed"),Page.$body.addClass("no-scroll"))}},Contact:{$elem:null,init:function(){this.$elem=$(".contact"),this.$elem.length&&new ContactForm($(".contact-form"))}}};$(Page.init);